version: '3.9'


services:
  mysql:
    container_name: mysql
    image: mysql
    restart: on-failure
    environment:
      - TZ=Asia/Seoul    
      - MYSQL_ROOT_PASSWORD=1111
    ports:
      - "3306:3306"
    volumes:
      - type: volume
        source: mysqldb
        target: /var/lib/mysql
      - type: bind
        source: ../workspace
        target: /workspace
    command:
      - --character-set-server=utf8mb4
      - --collation-server=utf8mb4_unicode_ci
  
  python:
    container_name: python-data
    build:
      context: .
      dockerfile: Dockerfile-py
    image: python-data:siu
    restart: on-failure
    environment:
      - TZ=Asia/Seoul
    stdin_open: true
    tty: true
    volumes:
      - type: bind
        source: ../workspace
        target: /workspace

  rstudio:
    container_name: rstudio
    build:
      context: .
      dockerfile: Dockerfile-R
    image: rocker/rstudio-kr:siu
    restart: on-failure
    environment:
      - PASSWORD=1111
      - TZ=Asia/Seoul
    ports:
      - "8787:8787"
    stdin_open: true
    tty: true
    volumes:
      - type: bind
        source: ../workspace
        target: /home/rstudio/projects
      - type: volume
        source: rstudio
        target: /home/rstudio
      - type: volume
        source: r_libs
        target: /usr/local/lib/R


volumes:
  r_libs:
    name: r_libs
  rstudio:
    name: rstudio
  mysqldb:
    name: mysqldb

